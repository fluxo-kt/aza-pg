# SECURITY: After copying this file to .env, set restrictive permissions:
#   chmod 600 .env
# Never commit .env files to version control!

# Project Configuration
COMPOSE_PROJECT_NAME=aza-pg

# Postgres Image
# For development (auto-updates with new builds):
POSTGRES_IMAGE=ghcr.io/fluxo-kt/aza-pg:pg18

# For production (immutable - recommended):
# POSTGRES_IMAGE=ghcr.io/fluxo-kt/aza-pg:18.0-202511092330-single-node  # Versioned tag
# POSTGRES_IMAGE=ghcr.io/fluxo-kt/aza-pg:pg18@sha256:<digest>  # SHA digest

# Container Names
POSTGRES_CONTAINER_NAME=postgres-primary
PGBOUNCER_CONTAINER_NAME=pgbouncer-primary
POSTGRES_EXPORTER_CONTAINER_NAME=postgres-exporter-primary
PGBOUNCER_EXPORTER_CONTAINER_NAME=pgbouncer-exporter-primary

# Network Configuration
POSTGRES_BIND_IP=127.0.0.1
POSTGRES_PORT=5432
PGBOUNCER_BIND_IP=127.0.0.1
PGBOUNCER_PORT=6432
POSTGRES_EXPORTER_BIND_IP=127.0.0.1
POSTGRES_EXPORTER_PORT=9187
PGBOUNCER_EXPORTER_BIND_IP=127.0.0.1
PGBOUNCER_EXPORTER_PORT=9127

# Database Configuration
POSTGRES_DB=postgres
POSTGRES_USER=postgres
# SECURITY: Use strong passwords (â‰¥16 characters, mixed case/numbers/symbols, unique per service)
POSTGRES_PASSWORD=your_strong_password_here
PG_REPLICATION_PASSWORD=your_replication_password_here
PGBOUNCER_AUTH_PASS=your_pgbouncer_auth_password_here

# Replication Configuration
REPLICATION_SLOT_NAME=replica_slot_1

# Resource Limits (baseline: 2GB per auto-config design)
POSTGRES_MEMORY_LIMIT=2048m
POSTGRES_MEMORY_RESERVATION=1024m
PGBOUNCER_MEMORY_LIMIT=200m
PGBOUNCER_MEMORY_RESERVATION=100m
POSTGRES_EXPORTER_MEMORY_LIMIT=64m
POSTGRES_EXPORTER_MEMORY_RESERVATION=32m
PGBOUNCER_EXPORTER_MEMORY_LIMIT=32m
PGBOUNCER_EXPORTER_MEMORY_RESERVATION=16m

# Auto-Config Overrides (optional - auto-config detects from cgroup/meminfo if not set)
# POSTGRES_MEMORY=2048                    # Manual RAM override in MB (bypasses auto-detection)
# POSTGRES_SHARED_PRELOAD_LIBRARIES=pg_stat_statements,auto_explain,pg_cron,pgaudit  # Override preloaded extensions

# Advanced Configuration (optional)
# POSTGRES_INITDB_ARGS=                   # Additional initdb arguments (e.g., --locale=en_US.UTF-8)
# DISABLE_DATA_CHECKSUMS=false            # SECURITY WARNING: Set to true to disable data checksums (not recommended)

# PgBouncer Configuration (optional - sensible defaults provided)
# PGBOUNCER_SERVER_SSLMODE=prefer         # TLS mode to Postgres: disable|allow|prefer|require|verify-ca|verify-full
# PGBOUNCER_MAX_CLIENT_CONN=200           # Max client connections to PgBouncer
# PGBOUNCER_DEFAULT_POOL_SIZE=25          # Connection pool size per database
# PGBOUNCER_LISTEN_ADDR=127.0.0.1         # PgBouncer listen address (default: localhost)

# Optional: pgsodium Initialization (requires pgsodium extension and getkey script)
# ENABLE_PGSODIUM_INIT=false              # Enable pgsodium key generation and configuration

# Volume Names (must match compose.yml volume declarations)
POSTGRES_DATA_VOLUME=postgres_data
POSTGRES_BACKUP_VOLUME=postgres_backup

# Network Names
POSTGRES_NETWORK_NAME=postgres-primary-net
MONITORING_NETWORK=monitoring

# Exporter Images
POSTGRES_EXPORTER_IMAGE=prometheuscommunity/postgres-exporter:v0.18.1

# Development overrides (compose.dev.yml)
# Standard variables can be overridden with different defaults
# Example: POSTGRES_MEMORY_LIMIT=2000m for development
